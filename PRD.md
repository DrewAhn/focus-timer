# 📋 포모도로 타이머 (Pomodoro Timer) - 제품 요구사항 정의서 (PRD)

---

## 1. 개요

### 1.1 제품명
**FocusTimer** - 개발자와 디자이너를 위한 포모도로 타이머

### 1.2 제품 설명
집중력이 필요한 개발자와 디자이너를 위한 미니멀하고 세련된 포모도로 타이머 웹앱. 40분 집중 / 10분 휴식 사이클을 통해 생산성을 극대화할 수 있도록 돕는다.

### 1.3 타겟 유저
- 장시간 집중이 필요한 **개발자**
- 창작 작업을 하는 **디자이너**
- 시간 관리가 필요한 **프리랜서 및 재택근무자**

---

## 2. 기능 명세

### 2.1 핵심 기능

| 기능 | 설명 |
|------|------|
| **Focus 모드** | ⏱️ **40분(40:00)** 집중 타이머 |
| **Break 모드** | ☕ **10분(10:00)** 휴식 타이머 |
| **모드 전환** | Focus ↔ Break 모드 수동 전환 버튼 + 자동 전환 |
| **완전 자동 사이클** | 타이머 종료 → 2초 대기 → 다음 모드로 전환 → 시작 소리 → 타이머 자동 시작 |
| **타이머 제어** | Start(시작), Pause(일시정지), Reset(초기화) 버튼 |
| **시간 표시** | MM:SS 형식의 직관적인 시간 디스플레이 |
| **브라우저 탭 타이틀** | 남은 시간을 탭 제목에 실시간 표시 (예: "24:59 - Focus Timer") |
| **시작 사운드** | Focus 시작: 경쾌한 3번 띵-띵-띵 (1000Hz) / Break 시작: 차분한 1번 띵~ (500Hz) |
| **종료 사운드** | Web Audio API를 사용한 맑은 종소리 알림 🔔 |
| **시각적 알림** | 타이머 흔들림 애니메이션 + 모바일 진동 |
| **사운드 토글** | 종소리 ON/OFF 전환 기능 (설정 저장) |
| **반응형 디자인** | 모바일부터 데스크탑까지 완벽한 적응형 레이아웃 |

### 2.2 상세 동작 흐름

```
[초기 상태] → Focus 모드 (40:00)
     ↓
[Start 클릭] → 🔔 Focus 시작음 (띵-띵-띵) → 타이머 카운트다운 시작
     ↓
[Pause 클릭] → 타이머 일시정지 (다시 Start로 재개)
     ↓
[Reset 클릭] → 현재 모드의 초기 시간으로 복귀
     ↓
[Focus 종료 40:00→00:00] → 🔔 종료음 + 타이머 흔들림 + 진동(모바일)
     ↓
[2초 대기] → Break 모드로 전환 → 🔔 Break 시작음 (띵~) → Break 타이머 자동 시작 (10:00)
     ↓
[Break 종료 10:00→00:00] → 🔔 종료음 + 타이머 흔들림 + 진동(모바일)
     ↓
[2초 대기] → Focus 모드로 전환 → 🔔 Focus 시작음 (띵-띵-띵) → Focus 타이머 자동 시작 (40:00)
     ↓
(무한 자동 사이클 반복 - Start 버튼은 처음 한 번만 필요)
     ↓
[사운드 OFF] → 시작음/종료음 없음, 타이머 흔들림 + 진동만, 자동 사이클은 동일하게 작동
```

### 2.3 모드별 설정값

| 모드 | 시간 | 초(seconds) | 테마 컬러 |
|------|------|-------------|-----------|
| **Focus** | **40분** | 2400초 | 네온 민트 (#00FFCC) |
| **Break** | **10분** | 600초 | 네온 핑크 (#FF6B9D) |

---

## 3. UI/UX 설계

### 3.1 디자인 컨셉
- **다크 모드**: 어두운 배경 (#0D0D0D ~ #1A1A2E)
- **네온 포인트**: 메인 컬러 #00FFCC, 글로우 효과 적용
- **미니멀리즘**: 불필요한 요소 배제, 핵심 기능에 집중
- **모노스페이스 폰트**: 타이머 숫자에 고정폭 폰트 사용

### 3.2 화면 구성

```
┌─────────────────────────────────────┐
│                                     │
│  🍅 FocusTimer        [🔊 Sound]    │  ← 로고/타이틀 + 사운드 토글
│                                     │
│      ┌─────────┬─────────┐          │
│      │  Focus  │  Break  │          │  ← 모드 전환 탭
│      └─────────┴─────────┘          │
│                                     │
│           ╔═══════════╗             │
│           ║  ◯◯◯◯◯   ║             │  ← 원형 프로그레스 링
│           ║           ║             │
│           ║   40:00   ║             │  ← 타이머 디스플레이
│           ║           ║             │
│           ╚═══════════╝             │
│                                     │
│      [Start]  [Pause]  [Reset]      │  ← 제어 버튼 (색상 구분)
│                                     │
│         "Time to focus!"            │  ← 상태 메시지
│                                     │
└─────────────────────────────────────┘
```

### 3.3 UI 컴포넌트 상세

| 컴포넌트 | 스타일 |
|----------|--------|
| **배경** | 그라디언트 다크 (#0D0D0D → #1A1A2E) |
| **타이머 숫자** | 대형 폰트 (72px+), 네온 글로우 효과 |
| **모드 탭** | 활성 상태 시 네온 컬러 하이라이트 |
| **버튼** | 둥근 모서리, hover 시 글로우 효과 |
| **원형 프로그레스** | (선택) 남은 시간 시각화 링 |

### 3.4 컬러 팔레트

| 용도 | 컬러 코드 | 설명 |
|------|-----------|------|
| 배경 (메인) | `#0D0D0D` | 다크 블랙 |
| 배경 (서브) | `#1A1A2E` | 네이비 블랙 |
| 포인트 (Focus) | `#00FFCC` | 네온 민트 |
| 포인트 (Break) | `#FF6B9D` | 네온 핑크 |
| START 버튼 | `#A78BFA` | 라이트 퍼플 |
| PAUSE 버튼 | `#60A5FA` | 라이트 블루 |
| RESET 버튼 | `#FB923C` | 라이트 오렌지 |
| 사운드 ON | `#FCD34D` | 골드/앰버 |
| 사운드 OFF | `#888888` | 회색 |
| 텍스트 (메인) | `#FFFFFF` | 흰색 |
| 텍스트 (서브) | `#888888` | 중간 회색 |

---

## 4. 기술 사양

### 4.1 기술 스택
- **HTML5**: 시맨틱 마크업
- **CSS3**: Flexbox, CSS Variables, Animations, Responsive Design
- **Vanilla JavaScript**: ES6+ 문법
- **Web Audio API**: 종소리 합성
- **Vibration API**: 모바일 진동 알림
- **LocalStorage**: 사운드 설정 저장

### 4.2 파일 구조
```
index.html  ← 단일 파일 (HTML + CSS + JS 인라인)
```

### 4.3 주요 JavaScript 로직

```javascript
// 핵심 상태 변수
- currentMode: 'focus' | 'break'
- timeLeft: number (초 단위)
- isRunning: boolean
- timerInterval: number | null
- soundEnabled: boolean (localStorage에서 로드)
- audioContext: AudioContext | null (전역 관리, 모바일 호환성)

// 시간 상수
- FOCUS_TIME: 2400 (40분)
- BREAK_TIME: 600 (10분)

// 핵심 함수
- initAudioContext(): AudioContext 초기화 및 resume (모바일 호환성)
- startTimer(autoStart): 타이머 시작 (AudioContext 초기화 포함)
- pauseTimer(): 타이머 일시정지
- resetTimer(): 타이머 초기화
- switchMode(mode): 모드 전환
- updateDisplay(): 화면 및 브라우저 탭 타이틀 업데이트
- playAlert(): 알림 실행 (사운드 설정 확인)
- playFocusStartSound(): Focus 시작 소리 (띵-띵-띵)
- playBreakStartSound(): Break 시작 소리 (띵~)
- playBellSound(): Web Audio API로 종료 종소리 생성
- playVisualAlert(): 시각적 알림 (타이머 흔들림 + 진동)
- toggleSound(): 사운드 ON/OFF 전환
- updateSoundToggleUI(): 사운드 버튼 UI 업데이트
```

### 4.4 브라우저 호환성

| 브라우저 | 지원 버전 | 알림 방식 | 모바일 자동재생 |
|----------|-----------|-----------|-----------------|
| Chrome (Desktop) | 34+ | 종소리 + 시각적 알림 | N/A |
| Chrome (Mobile) | 최신 | 종소리 + 시각적 + 진동 | ✅ 지원 |
| Firefox | 25+ | 종소리 + 시각적 알림 | ✅ 지원 |
| Safari (Desktop) | 14.1+ | 종소리 + 시각적 알림 | N/A |
| Safari (iOS) | 14.5+ | 종소리 + 시각적 + 진동 | ✅ 지원 |
| Edge | 12+ | 종소리 + 시각적 알림 | ✅ 지원 |
| IE | ❌ | 시각적 알림만 | ❌ |

**모바일 자동재생 지원**: AudioContext 전역 관리로 사용자 제스처 후 자동 전환 시에도 소리 재생 가능

---

## 5. 사용자 시나리오

### 시나리오 1: 완전 자동 포모도로 사이클
1. 사용자가 페이지 접속 → Focus 모드 (**40:00**) 표시
2. [Start] 클릭 → 🔔 Focus 시작음 (띵-띵-띵) → 타이머 시작, 브라우저 탭에 "40:00 - Focus Timer"
3. **40분 후** 타이머 종료 → 🔔 종료음 + 타이머 흔들림 + "Switching to break..." 메시지
4. **2초 후** Break 모드로 전환 → 🔔 Break 시작음 (띵~) → **Break 타이머 자동 시작 (10:00)**
5. 브라우저 탭에 "10:00 - Break Timer" 표시, "Break time! Take a rest ☕" 메시지
6. **10분 후** 타이머 종료 → 🔔 종료음 + 타이머 흔들림 + "Switching to focus..." 메시지
7. **2초 후** Focus 모드로 전환 → 🔔 Focus 시작음 (띵-띵-띵) → **Focus 타이머 자동 시작 (40:00)**
8. "Ready to focus again! 💪" 메시지
9. **이후 무한 자동 반복** (사용자 개입 없이 계속 진행)

### 시나리오 2: 중간 일시정지
1. Focus 모드 타이머 진행 중 (25:32 남음)
2. [Pause] 클릭 → 타이머 정지, 시간 유지
3. [Start] 클릭 → 25:32부터 다시 시작

### 시나리오 3: 타이머 리셋
1. Focus 모드 타이머 진행 중 (20:00 남음)
2. [Reset] 클릭 → **40:00**으로 초기화

### 시나리오 4: 사운드 설정 변경
1. 사용자가 [🔊 Sound] 버튼 클릭 → [🔇 Muted]로 변경
2. 설정이 localStorage에 자동 저장
3. 타이머 종료 시 → 종소리 없이 시각적 알림만 실행
4. 페이지 새로고침 후에도 설정 유지

### 시나리오 5: 모바일 사용
1. 스마트폰에서 페이지 접속 → 반응형 레이아웃 자동 적용
2. 타이머 시작 → 다른 앱으로 전환
3. 브라우저 탭 확인 → 남은 시간 실시간 표시
4. 타이머 종료 → 종소리 + 진동 알림

---

## 6. 구현된 주요 기능

### 6.1 완료된 기능 ✅
- ✅ 40분 Focus / 10분 Break 타이머
- ✅ 완전 자동 사이클 (모드 전환 + 타이머 자동 시작)
- ✅ 모드별 시작 소리 (Focus: 띵-띵-띵 / Break: 띵~)
- ✅ 타이머 종료 소리 (Web Audio API)
- ✅ 모바일 크롬 소리 재생 지원 (AudioContext 전역 관리)
- ✅ 자동 전환 시 소리 재생 (모바일 포함)
- ✅ 원형 프로그레스 바
- ✅ 브라우저 탭 타이틀에 실시간 시간 표시
- ✅ Fallback 시각적 알림 (구형 브라우저)
- ✅ 사운드 ON/OFF 토글
- ✅ localStorage 설정 저장
- ✅ 모바일 진동 알림
- ✅ 완전한 반응형 디자인 (320px~)
- ✅ 세련된 버튼 색상 체계 (퍼플/블루/오렌지/골드)
- ✅ 다크모드 UI

### 6.2 향후 확장 가능성 (Out of Scope)

> v3.0 이후 고려 가능한 기능들

- ⏰ 사용자 정의 시간 설정 (커스텀 Focus/Break 시간)
- 📊 세션 통계 및 기록 (일별/주별 집중 시간)
- 🌐 PWA 지원 (오프라인 사용, 앱 설치)
- 🎨 테마 커스터마이징 (라이트 모드, 커스텀 색상)
- 🔔 브라우저 알림 API (Notification API)
- 🎵 다양한 알림음 선택
- ⚙️ 롱 브레이크 기능 (4 포모도로마다 긴 휴식)

---

## 7. 성공 지표

| 지표 | 목표 | 달성 여부 |
|------|------|-----------|
| 페이지 로드 시간 | < 1초 | ✅ 단일 HTML 파일 |
| 타이머 정확도 | ±1초 이내 | ✅ setInterval 사용 |
| 브라우저 호환성 | Chrome, Firefox, Safari, Edge | ✅ Web Audio API + Fallback |
| 모바일 최적화 | 320px부터 지원 | ✅ 완전한 반응형 |
| 접근성 | 직관적인 UI | ✅ 색상 구분, 명확한 레이블 |

---

## 8. 릴리즈 노트

### v2.3 (2025년 12월 17일) - 현재 버전 🎉

**주요 업데이트:**
- 📱 **모바일 크롬 소리 재생 지원**
  - AudioContext 전역 관리로 모바일 자동재생 정책 우회
  - 사용자 제스처 후 AudioContext 초기화 및 재사용
  - 자동 전환 시에도 모바일에서 소리 정상 재생
  - `audioContext.resume()` 자동 호출로 suspended 상태 해결
- 🔊 **크로스 플랫폼 오디오 호환성 개선**
  - PC/모바일 모든 환경에서 일관된 소리 재생
  - iOS Safari, Android Chrome 완벽 지원

### v2.2 (2025년 12월 17일)

**주요 업데이트:**
- 🎵 **모드별 시작 소리 추가**
  - Focus 시작: 경쾌한 3번 "띵-띵-띵" (1000Hz)
  - Break 시작: 차분한 1번 "띵~" (500Hz + 400Hz 화음)
  - 수동 시작, Reset 후 시작, 자동 전환 시 모두 적용
- 🔄 **완전 자동 사이클 구현**
  - 타이머 종료 후 자동으로 다음 모드로 전환
  - 시작 소리와 함께 타이머 자동 시작
  - Start 버튼은 처음 한 번만 클릭하면 무한 반복
- 🎚️ **음량 최적화**
  - Focus 시작음: 30% (선명하고 경쾌)
  - Break 시작음: 20% (부드럽고 차분)
  - 종료 알림음: 22% (적당한 강도)

### v2.1 (2025년 12월 17일)

**주요 업데이트:**
- 🔄 자동 모드 전환 기능 추가
- ⏱️ 2초 대기 후 다음 모드로 전환

### v2.0 (2025년 12월 17일)

**주요 업데이트:**
- 🔊 Web Audio API 종소리 알림 추가
- 🎚️ 사운드 ON/OFF 토글 기능
- 🌐 브라우저 탭 타이틀 실시간 시간 표시
- 📱 완전한 반응형 디자인 (모바일 최적화)
- 🎨 세련된 버튼 색상 체계 (퍼플/블루/오렌지/골드)
- 📳 모바일 진동 알림
- 💾 localStorage 설정 저장
- 🛡️ IE 및 구형 브라우저 Fallback 지원
- 🎯 타이머 흔들림 시각적 알림

### v1.1 (2025년 12월 17일)
- ⏰ Focus 시간 25분 → 40분 변경
- ☕ Break 시간 5분 → 10분 변경

### v1.0 (2025년 12월 17일)
- 🎉 초기 릴리즈
- 기본 포모도로 타이머 기능
- 다크모드 UI
- Focus/Break 모드 전환

---

**최종 업데이트**: 2025년 12월 17일  
**현재 버전**: v2.3  
**개발 상태**: ✅ 완료 (Production Ready)

---

## 9. 모바일 호환성 상세

### 9.1 모바일 자동재생 정책 대응

모바일 브라우저는 사용자 경험 보호를 위해 자동 오디오 재생을 제한합니다. FocusTimer는 다음과 같이 대응했습니다:

**문제:**
- 모바일 브라우저에서 사용자 제스처 없이 소리 재생 차단
- AudioContext가 'suspended' 상태로 시작됨
- 자동 전환 시 소리가 나지 않음

**해결:**
1. **전역 AudioContext 관리**: 한 번 생성한 AudioContext를 재사용
2. **사용자 제스처 시 초기화**: Start 버튼 클릭/터치 시 AudioContext 활성화
3. **자동 resume**: suspended 상태 감지 시 자동으로 resume 호출
4. **컨텍스트 재사용**: 자동 전환 시 이미 활성화된 AudioContext 사용

### 9.2 테스트된 모바일 환경

| 기기 | OS | 브라우저 | 소리 | 진동 |
|------|-----|----------|------|------|
| iPhone 13 | iOS 16+ | Safari | ✅ | ✅ |
| iPhone 13 | iOS 16+ | Chrome | ✅ | ✅ |
| Galaxy S21 | Android 12+ | Chrome | ✅ | ✅ |
| Galaxy S21 | Android 12+ | Samsung Internet | ✅ | ✅ |
| iPad Pro | iPadOS 16+ | Safari | ✅ | ✅ |

### 9.3 알려진 제한사항

- ⚠️ 일부 구형 안드로이드 기기(Android 8 이하)에서는 Web Audio API 지원 제한
- ⚠️ iOS 무음 모드 활성화 시 소리 재생 안 됨 (진동만 작동)
- ⚠️ 백그라운드 상태에서는 브라우저 정책에 따라 타이머 정확도 저하 가능

